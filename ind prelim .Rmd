---
title: "Individual project pre analysis"
author: "Claire Campion"
date: "5/1/2022"
output: pdf_document
bibliography: bib3.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Overview
Bumble bee populations are increasingly under threat from habitat fragmentation, pesticides, pathogens, and climate change. Climate is likely a prime driver of declines in abundance and distribution, as bumble bees are limited by their thermal tolerance @kerr2015. However, the tolerance of whole organisms often exceeds that of their gametes; for example, insects can be sterilized by temperatures below their upper thermal tolerances @van_heerwaarden2021, @david2005. In Bombus, males are independent from the colony and can withstand extreme temperatures, but whether these temperatures compromise spermatozoa is unclear. Using commercially-reared Bombus impatiens males, we measured how exposure to sublethal temperatures near male critical thermal minimum and maximum impact spermatozoa viability. We measured temperature effects on spermatozoa in intact males to determine if males are potentially protecting spermatozoa. A LIVE/DEAD™ Cell Imaging Kit (Invitrogen™) and cell counter (Nexcelom Cellometer Spectrum Image Cytometry System) were used to estimate sperm count and viability in males exposed to 45°C for 85 minutes and 4°C for 85 min and 48 hours. Cells were stained with LIVE/DEAD kit immediatly after temperature exposures and were compared to control males which were held at room temperature (22°C) throughout experiment.The purpose of this study is to determine how exposure time may influence temperature effects on viability. This gap is important to address as bumble bee populations continue to decline and potential sterility to males could be a contributing factor. 

My goal for this project is to be able to create box plots and violin graphs to display these results and to prepare them to be published. 

# 2. Dataset
The dataset I will be using for this experiment include cell counts of male spermatozoa. The data consisits of live cells, dead cells, total cells, and percent viability(live/total). Other information included in the datsets are treatment, date, colony, species, date, mass, beeid, image number, and sex. I get my data from a automated microscope and I take 3 images of each sample and average them to get a accurate calculation of the cell count. I have 2 datasets, one for cold and one for heat treatment as explained above. 

I anticipate there not being many issues with this data but I want to explore some addition asepcts I could add to my boxplot such as changing the y axis to log scale or creating a histogram to see if differences are due to mass or other variables. 


```{r datasets}
chillvia <- read_xlsx("chillcoma exp.xlsx") 
heatvia <- read_xlsx("heat exp.xlsx") 
```


```{packages}
install.packages("tidyverse")
library(tidyverse)
library(readxl)
library(ggplot2)

```
## Tidying Data
In this section, my goal is to tidy data, make sure all columns are correct data type, removing any potential NAs, calculating the mean live, dead, and total counts for each unique beeID, and grouping by bee ID. 

```{tidy datasets}
#For the chill dataset, I using the mutate function to assign each column is the correct data type 
chillvia<- chillvia %>%
  mutate(treat=factor(treat), 
         time=as.numeric(time),
         live=as.numeric(live), 
         dead=as.numeric(dead), 
         total=as.numeric(total), 
         pc_viability=as.numeric(pc_viability))

#Next I am grouping the dataset by BeeID and using summarize to calculate the means for viability, live, dead, total cell counts, mass, and time. I also am taking the unique value of each beeIDs treatment and colony. 
cvia1 <- chillvia %>% 
  group_by(beeid) %>%
  summarize(via = mean(pc_viability, na.rm=TRUE), 
            live = mean(live, na.rm=TRUE), 
            dead = mean(dead, na.rm=TRUE),
            total= live+dead,
            treat = unique(treat),
            time = mean(time, na.rm=T), 
            mass = mean(mass, na.rm=TRUE),
            colony = unique(colony))

#For the heat dataset, I using the mutate function to assign each column is the correct data type
heatvia<- heatvia %>%
  mutate(treat=factor(treat), 
         time=as.numeric(time),
         live=as.numeric(live), 
         dead=as.numeric(dead), 
         total=as.numeric(total), 
         pc_viability=as.numeric(pc_viability))

#Next I am grouping the dataset by BeeID and using summarize to calculate the means for viability, live, dead, total cell counts, mass, and time. I also am taking the unique value of each beeIDs treatment and colony. 
hvia1 <-  heatvia %>% 
  group_by(beeid) %>%
  summarize(via = mean(pc_viability, na.rm=TRUE), 
            live = mean(live, na.rm=TRUE), 
            dead = mean(dead, na.rm=TRUE),
            total= live+dead,
            treat = unique(treat),
            time = mean(time, na.rm=T), 
            mass = mean(mass, na.rm=TRUE),
            colony = unique(colony))

```


```{boxplots}
cvia1 %>%   
  ggplot(aes(x=treat, y=via, fill=treat)) +
  geom_boxplot(outlier.colour = NA) +
  geom_jitter(position = position_jitterdodge())







```




